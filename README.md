# MPラーニング自動受講ツール (Selenium版 v3)

バックグラウンドで動作可能な半自動受講ツールです。

## 機能

| 機能 | 説明 |
|------|------|
| 動画終了検出 | `次の学習へ`/`テストへ` ボタンを自動クリック |
| 自動再生 | ページ遷移後に動画を自動再生 |
| 一時停止復帰 | 誤って停止しても自動で再開 |
| テスト自動回答 | 全問の最初の選択肢を選択して提出 |
| 解説画面スキップ | 「次へ」ボタンを自動クリック |
| アンケートスキップ | 「終了」ボタンを自動クリック |
| **連続受講** | 複数講座を予約して自動で連続受講 |

## 使い方

### 1. 起動
```bash
pip install selenium webdriver-manager
python mp_learning_selenium.py
```

### 2. 単発受講
1. 「**ブラウザ起動**」→ ログイン
2. 受けたい講座をクリック → ポップアップが開く
3. 「**監視開始**」→ 自動受講スタート

### 3. 連続受講（複数講座を自動で連続）
1. 「**ブラウザ起動**」→ ログイン
2. マイページで受けたい講座をクリック → ポップアップが開く
3. 「**この講座を予約**」ボタンを押す → ポップアップが閉じてリストに追加
4. 手順2〜3を繰り返して複数講座を予約
5. 「**連続受講開始**」→ 自動で1件ずつ開いて受講

#### 講座の探し方
- **新着講座**: マイページのスライダーからクリック
- **新着以外**: アコーディオンメニューを展開してクリック

### 4. 停止
- 「**監視停止**」ボタンをクリック
- ウィンドウを閉じると終了確認が表示されます

## 動画視聴のルール（重要）

MPラーニングでは、動画をスキップせずに最後まで視聴しないと次へ進めません。

| 行動 | 結果 |
|------|------|
| 2.5秒以上先にスキップ | ❌ ボタン出ない |
| 2.5秒以内の早送り | ✅ 許容される |
| 最初から最後まで再生 | ✅ ボタン出る |
| 途中で一時停止 | ✅ 問題なし |

## ファイル構成

| ファイル | 説明 |
|----------|------|
| `mp_learning_selenium.py` | メインツール |
| `memo.md` | 開発メモ・引き継ぎ |
| `icon.ico` | アイコン |

## 技術情報

- **Selenium WebDriver**: Chrome自動操作
- **EQプレイヤーAPI**: `player.accessor.play()` で再生制御
- **連続受講の仕組み**: マイページのリンクをSeleniumでクリック。新着以外は `lnkNewLesson_OnClick` をJS直接呼び出し

## 注意事項

- テスト自動回答は **全問最初の選択肢** を選びます（正解ではありません）
- 講座の単位取得には合格点が必要な場合があります
- 1日4単位の上限があります
