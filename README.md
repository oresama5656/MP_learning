# MPラーニング自動受講ツール (Selenium版)

バックグラウンドで動作可能な半自動受講ツールです。

## 機能

| 機能 | 説明 |
|------|------|
| 動画終了検出 | `次の学習へ`/`テストへ` ボタンを自動クリック |
| 自動再生 | ページ遷移後に動画を自動再生 |
| 一時停止復帰 | 誤って停止しても自動で再開 |
| テスト自動回答 | 全問の最初の選択肢を選択して提出 |
| 解説画面スキップ | 「次へ」ボタンを自動クリック |
| アンケートスキップ | 「終了」ボタンを自動クリック |

## 使い方

### 1. 起動
```bash
python mp_learning_selenium.py
```

### 2. 操作手順
1. **ブラウザ起動** ボタンをクリック
2. ログインページが開くので、手動でログイン
3. 受講したい講座を選択し、**動画再生画面（ポップアップ）** を開く
4. **監視開始** ボタンをクリック → 自動受講スタート！

### 3. 停止
- **監視停止** ボタンをクリック
- ウィンドウを閉じると終了確認が表示されます

## 必要なライブラリ

```bash
pip install selenium webdriver-manager
```

## 動画視聴のルール（重要）

MPラーニングでは、動画をスキップせずに最後まで視聴しないと次へ進めません。

### なぜスキップできないのか

サイト側で以下のチェックが行われています：

1. **累積視聴時間の追跡**: `videoLookTime` 変数で視聴時間を記録
2. **スキップ検出**: シークバーで **2.5秒以上** 先に移動すると、その分の視聴時間がカウントされない
3. **完視聴判定**: `動画の長さ - 2秒` 以上視聴しないとボタンが表示されない

| 行動 | 結果 |
|------|------|
| 2.5秒以上先にスキップ | ❌ ボタン出ない |
| 2.5秒以内の早送り | ✅ 許容される |
| 最初から最後まで再生 | ✅ ボタン出る |
| 途中で一時停止 | ✅ 問題なし |

## ファイル構成

| ファイル | 説明 |
|----------|------|
| `mp_learning_selenium.py` | メインツール（Selenium版） |
| `inspect_mp_learning.py` | HTML調査ツール |

## 技術情報

- **Selenium WebDriver**: Chrome自動操作
- **EQプレイヤーAPI**: `player.accessor.play()` で再生制御
- **オートプレイ対策**: クリック後にAPI呼び出しでブラウザポリシー回避

## 注意事項

- テスト自動回答は **全問最初の選択肢** を選びます（正解ではありません）
- 講座の単位取得には合格点が必要な場合があります
- 1日4単位の上限があります
